{
  "learning_records": [
    {
      "id": "SCAN-20251021-013747-3a1a67a2",
      "timestamp": "2025-10-21T01:37:47.801620",
      "contract_hash": "3a1a67a2b94134e0",
      "vulnerabilities_found": [
        "just_in_time_liquidity_attack",
        "stale_oracle_price_exploitation",
        "cross_function_reentrancy",
        "cross_function_reentrancy",
        "cross_function_reentrancy",
        "cross_function_reentrancy",
        "cross_function_reentrancy",
        "read_only_reentrancy",
        "twap_manipulation_short_window",
        "multiple_external_calls_no_guard",
        "multiple_external_calls_no_guard",
        "multiple_external_calls_no_guard",
        "multiple_external_calls_no_guard",
        "potential_backdoor",
        "unchecked_call_return_value",
        "unchecked_call_return_value",
        "unchecked_call_return_value"
      ],
      "false_positives_marked": [],
      "patterns_extracted": [
        {
          "type": "just_in_time_liquidity_attack",
          "severity": "medium",
          "indicators": [],
          "detection_strategy": "static_analysis"
        },
        {
          "type": "stale_oracle_price_exploitation",
          "severity": "high",
          "indicators": [],
          "detection_strategy": "static_analysis"
        },
        {
          "type": "cross_function_reentrancy",
          "severity": "high",
          "indicators": [],
          "detection_strategy": "static_analysis"
        },
        {
          "type": "cross_function_reentrancy",
          "severity": "high",
          "indicators": [],
          "detection_strategy": "static_analysis"
        },
        {
          "type": "cross_function_reentrancy",
          "severity": "high",
          "indicators": [],
          "detection_strategy": "static_analysis"
        },
        {
          "type": "cross_function_reentrancy",
          "severity": "high",
          "indicators": [],
          "detection_strategy": "static_analysis"
        },
        {
          "type": "cross_function_reentrancy",
          "severity": "high",
          "indicators": [],
          "detection_strategy": "static_analysis"
        },
        {
          "type": "read_only_reentrancy",
          "severity": "medium",
          "indicators": [],
          "detection_strategy": "static_analysis"
        },
        {
          "type": "twap_manipulation_short_window",
          "severity": "high",
          "indicators": [],
          "detection_strategy": "static_analysis"
        },
        {
          "type": "multiple_external_calls_no_guard",
          "severity": "high",
          "indicators": [],
          "detection_strategy": "static_analysis"
        },
        {
          "type": "multiple_external_calls_no_guard",
          "severity": "high",
          "indicators": [],
          "detection_strategy": "static_analysis"
        },
        {
          "type": "multiple_external_calls_no_guard",
          "severity": "high",
          "indicators": [],
          "detection_strategy": "static_analysis"
        },
        {
          "type": "multiple_external_calls_no_guard",
          "severity": "high",
          "indicators": [],
          "detection_strategy": "static_analysis"
        },
        {
          "type": "potential_backdoor",
          "severity": "critical",
          "indicators": [],
          "detection_strategy": "static_analysis"
        },
        {
          "type": "unchecked_call_return_value",
          "severity": "high",
          "indicators": [],
          "detection_strategy": "static_analysis"
        },
        {
          "type": "unchecked_call_return_value",
          "severity": "high",
          "indicators": [],
          "detection_strategy": "static_analysis"
        },
        {
          "type": "unchecked_call_return_value",
          "severity": "high",
          "indicators": [],
          "detection_strategy": "static_analysis"
        }
      ],
      "accuracy_score": 1.0,
      "processing_time": 0.013497,
      "llm_insights": []
    },
    {
      "id": "SCAN-20251021-013757-14059bcb",
      "timestamp": "2025-10-21T01:37:57.811622",
      "contract_hash": "14059bcbb761be63",
      "vulnerabilities_found": [
        "just_in_time_liquidity_attack",
        "flash_loan_governance_attack",
        "stale_oracle_price_exploitation",
        "cross_function_reentrancy",
        "cross_function_reentrancy",
        "cross_function_reentrancy",
        "cross_function_reentrancy",
        "cross_function_reentrancy",
        "cross_function_reentrancy",
        "cross_function_reentrancy",
        "cross_function_reentrancy",
        "cross_function_reentrancy",
        "cross_function_reentrancy",
        "read_only_reentrancy",
        "governance_proposal_spam",
        "multiple_external_calls_no_guard",
        "multiple_external_calls_no_guard",
        "multiple_external_calls_no_guard",
        "multiple_external_calls_no_guard",
        "multiple_external_calls_no_guard",
        "multiple_external_calls_no_guard",
        "potential_backdoor",
        "unchecked_call_return_value",
        "unchecked_call_return_value",
        "unchecked_call_return_value",
        "unchecked_call_return_value"
      ],
      "false_positives_marked": [],
      "patterns_extracted": [
        {
          "type": "just_in_time_liquidity_attack",
          "severity": "medium",
          "indicators": [],
          "detection_strategy": "static_analysis"
        },
        {
          "type": "flash_loan_governance_attack",
          "severity": "critical",
          "indicators": [],
          "detection_strategy": "static_analysis"
        },
        {
          "type": "stale_oracle_price_exploitation",
          "severity": "high",
          "indicators": [],
          "detection_strategy": "static_analysis"
        },
        {
          "type": "cross_function_reentrancy",
          "severity": "high",
          "indicators": [],
          "detection_strategy": "static_analysis"
        },
        {
          "type": "cross_function_reentrancy",
          "severity": "high",
          "indicators": [],
          "detection_strategy": "static_analysis"
        },
        {
          "type": "cross_function_reentrancy",
          "severity": "high",
          "indicators": [],
          "detection_strategy": "static_analysis"
        },
        {
          "type": "cross_function_reentrancy",
          "severity": "high",
          "indicators": [],
          "detection_strategy": "static_analysis"
        },
        {
          "type": "cross_function_reentrancy",
          "severity": "high",
          "indicators": [],
          "detection_strategy": "static_analysis"
        },
        {
          "type": "cross_function_reentrancy",
          "severity": "high",
          "indicators": [],
          "detection_strategy": "static_analysis"
        },
        {
          "type": "cross_function_reentrancy",
          "severity": "high",
          "indicators": [],
          "detection_strategy": "static_analysis"
        },
        {
          "type": "cross_function_reentrancy",
          "severity": "high",
          "indicators": [],
          "detection_strategy": "static_analysis"
        },
        {
          "type": "cross_function_reentrancy",
          "severity": "high",
          "indicators": [],
          "detection_strategy": "static_analysis"
        },
        {
          "type": "cross_function_reentrancy",
          "severity": "high",
          "indicators": [],
          "detection_strategy": "static_analysis"
        },
        {
          "type": "read_only_reentrancy",
          "severity": "medium",
          "indicators": [],
          "detection_strategy": "static_analysis"
        },
        {
          "type": "governance_proposal_spam",
          "severity": "medium",
          "indicators": [],
          "detection_strategy": "static_analysis"
        },
        {
          "type": "multiple_external_calls_no_guard",
          "severity": "high",
          "indicators": [],
          "detection_strategy": "static_analysis"
        },
        {
          "type": "multiple_external_calls_no_guard",
          "severity": "high",
          "indicators": [],
          "detection_strategy": "static_analysis"
        },
        {
          "type": "multiple_external_calls_no_guard",
          "severity": "high",
          "indicators": [],
          "detection_strategy": "static_analysis"
        },
        {
          "type": "multiple_external_calls_no_guard",
          "severity": "high",
          "indicators": [],
          "detection_strategy": "static_analysis"
        },
        {
          "type": "multiple_external_calls_no_guard",
          "severity": "high",
          "indicators": [],
          "detection_strategy": "static_analysis"
        },
        {
          "type": "multiple_external_calls_no_guard",
          "severity": "high",
          "indicators": [],
          "detection_strategy": "static_analysis"
        },
        {
          "type": "potential_backdoor",
          "severity": "critical",
          "indicators": [],
          "detection_strategy": "static_analysis"
        },
        {
          "type": "unchecked_call_return_value",
          "severity": "high",
          "indicators": [],
          "detection_strategy": "static_analysis"
        },
        {
          "type": "unchecked_call_return_value",
          "severity": "high",
          "indicators": [],
          "detection_strategy": "static_analysis"
        },
        {
          "type": "unchecked_call_return_value",
          "severity": "high",
          "indicators": [],
          "detection_strategy": "static_analysis"
        },
        {
          "type": "unchecked_call_return_value",
          "severity": "high",
          "indicators": [],
          "detection_strategy": "static_analysis"
        }
      ],
      "accuracy_score": 1.0,
      "processing_time": 0.014412,
      "llm_insights": []
    }
  ],
  "pattern_effectiveness": {
    "just_in_time_liquidity_attack": {
      "pattern_name": "just_in_time_liquidity_attack",
      "times_detected": 2,
      "true_positives": 2,
      "false_positives": 0,
      "last_updated": "2025-10-21T01:37:57.811632",
      "confidence_score": 1.0
    },
    "stale_oracle_price_exploitation": {
      "pattern_name": "stale_oracle_price_exploitation",
      "times_detected": 2,
      "true_positives": 2,
      "false_positives": 0,
      "last_updated": "2025-10-21T01:37:57.811640",
      "confidence_score": 1.0
    },
    "cross_function_reentrancy": {
      "pattern_name": "cross_function_reentrancy",
      "times_detected": 15,
      "true_positives": 15,
      "false_positives": 0,
      "last_updated": "2025-10-21T01:37:57.811651",
      "confidence_score": 1.0
    },
    "read_only_reentrancy": {
      "pattern_name": "read_only_reentrancy",
      "times_detected": 2,
      "true_positives": 2,
      "false_positives": 0,
      "last_updated": "2025-10-21T01:37:57.811652",
      "confidence_score": 1.0
    },
    "twap_manipulation_short_window": {
      "pattern_name": "twap_manipulation_short_window",
      "times_detected": 1,
      "true_positives": 1,
      "false_positives": 0,
      "last_updated": "2025-10-21T01:37:47.801652",
      "confidence_score": 1.0
    },
    "multiple_external_calls_no_guard": {
      "pattern_name": "multiple_external_calls_no_guard",
      "times_detected": 10,
      "true_positives": 10,
      "false_positives": 0,
      "last_updated": "2025-10-21T01:37:57.811663",
      "confidence_score": 1.0
    },
    "potential_backdoor": {
      "pattern_name": "potential_backdoor",
      "times_detected": 2,
      "true_positives": 2,
      "false_positives": 0,
      "last_updated": "2025-10-21T01:37:57.811664",
      "confidence_score": 1.0
    },
    "unchecked_call_return_value": {
      "pattern_name": "unchecked_call_return_value",
      "times_detected": 7,
      "true_positives": 7,
      "false_positives": 0,
      "last_updated": "2025-10-21T01:37:57.811668",
      "confidence_score": 1.0
    },
    "flash_loan_governance_attack": {
      "pattern_name": "flash_loan_governance_attack",
      "times_detected": 1,
      "true_positives": 1,
      "false_positives": 0,
      "last_updated": "2025-10-21T01:37:57.811638",
      "confidence_score": 1.0
    },
    "governance_proposal_spam": {
      "pattern_name": "governance_proposal_spam",
      "times_detected": 1,
      "true_positives": 1,
      "false_positives": 0,
      "last_updated": "2025-10-21T01:37:57.811656",
      "confidence_score": 1.0
    }
  },
  "vulnerability_corpus": {
    "just_in_time_liquidity_attack": [
      "// SPDX-License-Identifier: MIT\npragma solidity ^0.8.0;\n\n/**\n * VULNERABLE VAULT CONTRACT - FOR TESTING ONLY\n * Contains multiple intentional vulnerabilities for demonstration\n * DO NOT USE IN PRODUCT",
      "// SPDX-License-Identifier: MIT\npragma solidity ^0.8.0;\n\ncontract VulnerableDeFiProtocol {\n    // Existing state\n    mapping(address => uint256) public balances;\n    mapping(address => bool) public is"
    ],
    "stale_oracle_price_exploitation": [
      "// SPDX-License-Identifier: MIT\npragma solidity ^0.8.0;\n\n/**\n * VULNERABLE VAULT CONTRACT - FOR TESTING ONLY\n * Contains multiple intentional vulnerabilities for demonstration\n * DO NOT USE IN PRODUCT",
      "// SPDX-License-Identifier: MIT\npragma solidity ^0.8.0;\n\ncontract VulnerableDeFiProtocol {\n    // Existing state\n    mapping(address => uint256) public balances;\n    mapping(address => bool) public is"
    ],
    "cross_function_reentrancy": [
      "// SPDX-License-Identifier: MIT\npragma solidity ^0.8.0;\n\n/**\n * VULNERABLE VAULT CONTRACT - FOR TESTING ONLY\n * Contains multiple intentional vulnerabilities for demonstration\n * DO NOT USE IN PRODUCT",
      "// SPDX-License-Identifier: MIT\npragma solidity ^0.8.0;\n\ncontract VulnerableDeFiProtocol {\n    // Existing state\n    mapping(address => uint256) public balances;\n    mapping(address => bool) public is"
    ],
    "read_only_reentrancy": [
      "// SPDX-License-Identifier: MIT\npragma solidity ^0.8.0;\n\n/**\n * VULNERABLE VAULT CONTRACT - FOR TESTING ONLY\n * Contains multiple intentional vulnerabilities for demonstration\n * DO NOT USE IN PRODUCT",
      "// SPDX-License-Identifier: MIT\npragma solidity ^0.8.0;\n\ncontract VulnerableDeFiProtocol {\n    // Existing state\n    mapping(address => uint256) public balances;\n    mapping(address => bool) public is"
    ],
    "twap_manipulation_short_window": [
      "// SPDX-License-Identifier: MIT\npragma solidity ^0.8.0;\n\n/**\n * VULNERABLE VAULT CONTRACT - FOR TESTING ONLY\n * Contains multiple intentional vulnerabilities for demonstration\n * DO NOT USE IN PRODUCT"
    ],
    "multiple_external_calls_no_guard": [
      "// SPDX-License-Identifier: MIT\npragma solidity ^0.8.0;\n\n/**\n * VULNERABLE VAULT CONTRACT - FOR TESTING ONLY\n * Contains multiple intentional vulnerabilities for demonstration\n * DO NOT USE IN PRODUCT",
      "// SPDX-License-Identifier: MIT\npragma solidity ^0.8.0;\n\ncontract VulnerableDeFiProtocol {\n    // Existing state\n    mapping(address => uint256) public balances;\n    mapping(address => bool) public is"
    ],
    "potential_backdoor": [
      "// SPDX-License-Identifier: MIT\npragma solidity ^0.8.0;\n\n/**\n * VULNERABLE VAULT CONTRACT - FOR TESTING ONLY\n * Contains multiple intentional vulnerabilities for demonstration\n * DO NOT USE IN PRODUCT",
      "// SPDX-License-Identifier: MIT\npragma solidity ^0.8.0;\n\ncontract VulnerableDeFiProtocol {\n    // Existing state\n    mapping(address => uint256) public balances;\n    mapping(address => bool) public is"
    ],
    "unchecked_call_return_value": [
      "// SPDX-License-Identifier: MIT\npragma solidity ^0.8.0;\n\n/**\n * VULNERABLE VAULT CONTRACT - FOR TESTING ONLY\n * Contains multiple intentional vulnerabilities for demonstration\n * DO NOT USE IN PRODUCT",
      "// SPDX-License-Identifier: MIT\npragma solidity ^0.8.0;\n\ncontract VulnerableDeFiProtocol {\n    // Existing state\n    mapping(address => uint256) public balances;\n    mapping(address => bool) public is"
    ],
    "flash_loan_governance_attack": [
      "// SPDX-License-Identifier: MIT\npragma solidity ^0.8.0;\n\ncontract VulnerableDeFiProtocol {\n    // Existing state\n    mapping(address => uint256) public balances;\n    mapping(address => bool) public is"
    ],
    "governance_proposal_spam": [
      "// SPDX-License-Identifier: MIT\npragma solidity ^0.8.0;\n\ncontract VulnerableDeFiProtocol {\n    // Existing state\n    mapping(address => uint256) public balances;\n    mapping(address => bool) public is"
    ]
  },
  "accuracy_history": [
    1.0,
    1.0
  ],
  "last_updated": "2025-10-21T01:37:57.811851",
  "total_scans": 2
}